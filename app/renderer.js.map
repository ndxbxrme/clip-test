{
  "version": 3,
  "file": "renderer.js",
  "sourceRoot": "../src/",
  "sources": [
    "renderer.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "navigator.mediaDevices.getUserMedia\r\n  audio: true\r\n.then (stream) ->\r\n  audio = new AudioContext()\r\n  source = audio.createMediaStreamSource stream\r\n  compressor = audio.createDynamicsCompressor()\r\n  analyser = audio.createAnalyser()\r\n  dest = audio.createMediaStreamDestination()\r\n  source.connect compressor\r\n  compressor.connect analyser\r\n  analyser.connect dest\r\n  analyser.fftSize = 2048\r\n  viz = require('./viz') analyser\r\n  $controls = document.querySelector '.controls'\r\n  $rec = document.querySelector '.rec'\r\n  $clips = document.querySelector '.clips'\r\n  $reduction = document.querySelector '.reduction'\r\n  cutoff =\r\n    toString: ->\r\n      'Cutoff'\r\n  recording = false\r\n  chunks = []\r\n  checkTime = 0\r\n  mediaRecorder = new MediaRecorder dest.stream\r\n  mediaRecorder.ondataavailable = (e) ->\r\n    chunks.push e.data\r\n  mediaRecorder.onstop = (e) ->\r\n    size = 0\r\n    for chunk in chunks\r\n      size += chunk.size\r\n    if size > cutoff.min_size\r\n      $audio = document.createElement 'audio'\r\n      $audio.controls = true\r\n      blob = new Blob chunks,\r\n        type: 'audio/ogg; codec=opus'\r\n      audioURL = URL.createObjectURL blob\r\n      $audio.src = audioURL\r\n      $clips.appendChild $audio\r\n    chunks = []\r\n  connectRange = (component, prop, val, step, min, max) ->\r\n    $control = document.createElement 'div'\r\n    $control.className = 'control'\r\n    input = document.createElement 'input'\r\n    input.type = 'range'\r\n    input.min = component[prop]?.minValue or min or 0\r\n    input.max = component[prop]?.maxValue or max or 0\r\n    input.step = step\r\n    input.value = val\r\n    label = document.createElement 'label'\r\n    labelText = (myval) ->\r\n      component.toString().replace(/\\[object |Node\\]/g, '') + ', ' + prop + ', ' + myval\r\n    input.oninput = (e) ->\r\n      if component[prop]?.setValueAtTime\r\n        component[prop].setValueAtTime input.value, audio.currentTime\r\n      else\r\n        component[prop] = input.value\r\n      label.innerHTML = labelText input.value\r\n    input.oninput()\r\n    $controls.appendChild $control\r\n    $control.appendChild label\r\n    $control.appendChild input\r\n  connectRange compressor, 'threshold', -75, 1\r\n  connectRange compressor, 'knee', 40, 1\r\n  connectRange compressor, 'ratio', 20, 0.1\r\n  connectRange compressor, 'attack', 0, 0.01\r\n  connectRange compressor, 'release', 0.25, 0.01\r\n  connectRange cutoff, 'time', .5, 0.01, 0, 5\r\n  connectRange cutoff, 'threshold', -10, 0.1, -40, 0\r\n  connectRange cutoff, 'min_size', 20000, 100, 1000, 100000\r\n\r\n  process = ->\r\n    requestAnimationFrame process\r\n    viz.draw()\r\n    $reduction.style.width = Math.min(100,(-compressor.reduction * 100 / 60)) + '%'\r\n    if compressor.reduction < +cutoff.threshold\r\n      if not recording\r\n        mediaRecorder.start()\r\n        $rec.className = 'rec recording'\r\n        recording = true\r\n        checkTime = 0\r\n    else\r\n      if not checkTime\r\n        checkTime = audio.currentTime + +cutoff.time\r\n      else\r\n        if audio.currentTime > checkTime\r\n          if recording\r\n            mediaRecorder.stop()\r\n            $rec.className = 'rec'\r\n            recording = false\r\n          checkTime = 0\r\n  process()\r\nmodule.exports =\r\n  deleteAllClips: ->\r\n    clips = document.querySelectorAll 'audio'\r\n    for clip in clips\r\n      clip.parentNode.removeChild clip"
  ]
}